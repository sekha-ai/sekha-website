# Reference

Technical reference documentation.

## Available References

- [**Performance Benchmarks**](benchmarks.md) - Performance data and comparisons

## Configuration

Full configuration reference available in:

- [Configuration Guide](../getting-started/configuration.md) - Complete config.toml reference

## API Documentation

API references available in:

- [REST API Reference](../api-reference/rest-api.md) - HTTP API endpoints
- [MCP Tools Reference](../api-reference/mcp-tools.md) - Model Context Protocol tools

## Data Models

### Conversation

```json
{
  "id": "string (UUID)",
  "title": "string",
  "content": "string",
  "labels": ["string"],
  "importance": 1-10,
  "status": "active | archived",
  "folder_id": "string (optional)",
  "created_at": "ISO 8601 timestamp",
  "updated_at": "ISO 8601 timestamp",
  "word_count": integer,
  "session_id": "string (optional)"
}
```

### Search Result

```json
{
  "id": "string (UUID)",
  "title": "string",
  "content": "string",
  "relevance_score": 0.0-1.0,
  "labels": ["string"],
  "importance": 1-10,
  "created_at": "ISO 8601 timestamp"
}
```

### Statistics

```json
{
  "total_conversations": integer,
  "total_words": integer,
  "active_conversations": integer,
  "archived_conversations": integer,
  "unique_labels": integer,
  "average_importance": float,
  "storage_size_bytes": integer
}
```

## Database Schema

See the [Controller Repository](https://github.com/sekha-ai/sekha-controller/tree/main/migrations) for migration files.

### Key Tables

**conversations**
- Primary storage for conversation data
- Full-text search index on title and content
- Importance and status indexes for filtering

**labels**
- Hierarchical label storage
- Many-to-many relationship with conversations

**folders**
- Optional folder organization
- Tree structure with parent_id

**summaries**
- Daily, weekly, monthly rollups
- Generated by summarization pipeline

## Vector Store

### ChromaDB Collections

**sekha_memory**
- Stores conversation embeddings
- Uses nomic-embed-text model (768 dimensions)
- Cosine similarity search

### Embedding Format

```json
{
  "id": "conversation-uuid",
  "embedding": [768 float values],
  "metadata": {
    "title": "string",
    "labels": "comma-separated",
    "importance": integer,
    "created_at": "timestamp"
  }
}
```

## Environment Variables

All config.toml values can be overridden:

```bash
# Format: SEKHA_<SECTION>_<KEY>
SEKHA_SERVER_PORT=8080
SEKHA_SERVER_API_KEY="your-api-key"
SEKHA_DATABASE_URL="postgresql://..."
SEKHA_VECTOR_STORE_CHROMA_URL="http://chroma:8000"
SEKHA_LLM_OLLAMA_URL="http://ollama:11434"
```

## Metrics (Coming Soon)

Prometheus metrics will be available at `/metrics`:

### Request Metrics
- `http_requests_total` - Total requests by endpoint
- `http_request_duration_seconds` - Request latency histogram
- `http_request_size_bytes` - Request size
- `http_response_size_bytes` - Response size

### Database Metrics
- `db_connections_active` - Active connections
- `db_connections_idle` - Idle connections
- `db_query_duration_seconds` - Query latency

### Vector Store Metrics
- `vector_search_duration_seconds` - Search latency
- `vector_embeddings_generated_total` - Embedding count

### LLM Metrics
- `llm_requests_total` - LLM API calls
- `llm_request_duration_seconds` - LLM latency
- `llm_tokens_used_total` - Token usage

## Next Steps

- [**Performance Benchmarks**](benchmarks.md) - Detailed performance data
- [**Configuration Guide**](../getting-started/configuration.md) - Config reference
- [**API Reference**](../api-reference/index.md) - REST and MCP APIs
